<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bet Scraping</title>

<script src="https://code.jquery.com/jquery-3.0.0.min.js"   integrity="sha256-JmvOoLtYsmqlsWxa7mDSLMwa6dZ9rrIdtrrVYRnDRH0="   crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.13.1/lodash.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.13.0/moment.js"></script>
<style>
    .match{
        width:40%;
        float: left;
    }
    .match ul{
        list-style: none;
        padding-left:0px;
    }
    .match li{
        margin:5px 0px;
    }
</style>
</head>
<body>
    <div class="content">
        <div id="matches">
        
        </div>
    </div>
<script>
(function (){
    $(function () {
        var action = window.location.search.toLowerCase().indexOf("ezy") > -1
            ? "ezy"
            : "moeg";
        if(window.location)
        $.get("http://barabatuswinwm.cloudapp.net/api/" + action, function (data){
            _.forEach(data, function (match){
                console.log(match);
                var matchContainer = $("<div class='match'\>");
                var start = moment(match.MatchStart);
                
                matchContainer.append("<h3>" + match.HomeTeam + " - " + match.AwayTeam + "</h3")
                matchContainer.append("<h3>" + start.format("YYYY-MM-DD HH:mm") + "</h3>")
                
                var list = $("<ul\>");
                _.forEach(match.BettingResults, function (bet){
                    list.append("<li>" + bet.Name + ": " + bet.Bet +"</ul>");
                })
                matchContainer.append(list)
                matchContainer.append("</div>")
                
                $("#matches").append(matchContainer)

            })
        });  
    });
})();
    
</script>
</body>
</html>
